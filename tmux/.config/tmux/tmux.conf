# --- 基础设置 ---
set -g status-style bg=default 
set -g base-index 1
setw -g pane-base-index 1
setw -g mode-keys vi

# 虽然我们主要用 Alt 键，但保留一个 Prefix 以备不时之需 (如嵌套 tmux 时)
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# --- 核心：去前缀化绑定 (使用 -n 参数) ---
# 注意：M 代表 Alt 键 (Meta)

# 1. 窗口分割 (Split) -> Alt + \ 和 Alt + -
unbind %
unbind '"'
bind -n M-\\ split-window -h -c "#{pane_current_path}"
bind -n M-- split-window -v -c "#{pane_current_path}"

bind -n M-Space select-pane -t :.+

# 3. 面板调整大小 (Resize) -> Alt + Shift + 方向键 (保持你原有的设置)
bind -n M-S-Left resize-pane -L 5
bind -n M-S-Right resize-pane -R 5
bind -n M-S-Up resize-pane -U 5
bind -n M-S-Down resize-pane -D 5

# 4. 复制模式与粘贴 (Copy Mode)
# 建议：使用 Alt + v 进入复制模式，Alt + p 粘贴
bind -n M-v copy-mode
bind -n M-p paste-buffer

# 复制模式内部的按键 (Copy Mode VI key table)
# 这些是在进入复制模式后使用的，不需要 -n
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -selection clipboard -i"
# 添加 Esc 退出复制模式 (习惯性设置)
bind-key -T copy-mode-vi Escape send-keys -X cancel

# 5. 窗口管理 (Window Management)
# 重命名 -> Alt + r
bind -n M-r command-prompt -I "#W" "rename-window '%%'"

# 新增建议：创建新窗口 -> Alt + c (非常常用)
bind -n M-c new-window -c "#{pane_current_path}"

# 新增建议：关闭当前面板/窗口 -> Alt + x (比默认的 prefix + x 更快)
bind -n M-x kill-pane

# --- 补充的高频操作 (全部去前缀) ---

# 1. 最大化/恢复当前面板 (Zoom) -> Alt + z
# 这个功能超级常用：暂时把一个小窗口全屏，看完再按一次恢复
bind -n M-z resize-pane -Z

# 2. 会话选择器 (Session Switcher) -> Alt + s
# 还在用 Prefix + s 吗？改成 Alt + s 瞬间列出所有项目
bind -n M-s choose-session

# 3. 快速重载配置文件 -> Alt + R (Shift + r)
# 改完配置不用重启 tmux，按一下立刻生效
bind -n M-R source-file ~/.config/tmux/tmux.conf \; display "Config Reloaded!"

# 6. 窗口切换 (Switch Window) -> Alt + 数字 (保持你原有的设置)
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9
bind -n M-0 select-window -t 10

bind -n M-/ display-popup -E -w 60% -h 60% -T " ✂️  Quick Snippets " "bash -c 'cat $HOME/dotfiles/docs/snippets.txt | fzf --reverse --border=none --prompt=\"Copy > \" | tr -d \"\\n\" | tmux load-buffer -w -'"
