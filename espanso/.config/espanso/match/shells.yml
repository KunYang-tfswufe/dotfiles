# ~/dotfiles/espanso/.config/espanso/match/shells.yml

matches:
  - trigger: "`tr"
    replace: |-
      find . -print | sed -e 's;[^/]*/;|____;g;s;____|; |;g'

  - trigger: "`fPI"
    replace: "sshfs pi@{{my_pi_ip}}: ~/pi_mnt_point/"
    vars:
      # 【最终方案】使用 'shell' 类型，并增加容错能力
      - &variable_pi_ip
        name: my_pi_ip
        type: shell
        params:
          # 如果 cat 命令失败 (因为文件不存在), 则 || 后面的 echo 命令会执行
          # 这确保了变量 my_pi_ip 永远都有一个值，Espanso 就不会报错
          cmd: "cat /home/imak/.pi_ip_address || echo 'IP_NOT_SET'"

  - trigger: "`sPI"
    replace: "kitten ssh pi@{{my_pi_ip}}"
    vars:
      - *variable_pi_ip
